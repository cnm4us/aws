<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Login</title>
    <style>
      *, *::before, *::after { box-sizing: border-box; }
      :root { color-scheme: dark; }
      html, body { height: 100%; background: #000; }
      body { margin: 0; display: grid; place-items: center; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: #fff; }
      .card { width: min(440px, 92vw); background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.15); border-radius: 14px; padding: 18px; box-shadow: 0 8px 24px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.06); }
      h1 { margin: 0 0 12px 0; font-size: 20px; font-weight: 600; }
      label { display: block; font-size: 14px; margin: 12px 0 6px; opacity: 0.85; }
      input { width: 100%; padding: 12px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.06); color: #fff; outline: none; font-size: 16px; }
      input::placeholder { color: rgba(255,255,255,0.6); }
      .error { color: #ff5252; margin-top: 8px; min-height: 1em; }
      .ok { color: #7CFC7C; margin-top: 8px; min-height: 1em; }
      button { width: 100%; margin-top: 14px; padding: 12px 16px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.15); color: #fff; background: #0a84ff; font-weight: 600; box-shadow: 0 6px 16px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.12); }
      .hint { font-size: 12px; opacity: 0.8; margin-top: 10px; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Sign in</h1>
      <form id="f">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required />
        <label for="password">Password</label>
        <input id="password" name="password" type="password" autocomplete="current-password" placeholder="Your password" required />
        <div class="error" id="err"></div>
        <div class="ok" id="ok"></div>
        <button type="submit">Login</button>
        <div class="hint">No email or phone verification required yet. This will improve in future updates.</div>
      </form>
    </div>
    <script>
      function getCsrfToken() {
        const m = document.cookie.match(/(?:^|;)\s*csrf=([^;]+)/);
        return m ? decodeURIComponent(m[1]) : null;
      }
      const f = document.getElementById('f');
      const err = document.getElementById('err');
      const ok = document.getElementById('ok');
      f.addEventListener('submit', async (e) => {
        e.preventDefault(); err.textContent = ''; ok.textContent='';
        const email = f.email.value.trim();
        const password = f.password.value;
        try {
          const headers = { 'content-type': 'application/json' };
          const csrf = getCsrfToken();
          if (csrf) headers['x-csrf-token'] = csrf;
          const res = await fetch('/api/login', { method:'POST', headers, body: JSON.stringify({ email, password }) });
          const data = await res.json().catch(()=>({}));
          if (!res.ok) { err.textContent = data && data.error ? data.error : 'Login failed'; return; }
          ok.textContent = 'Logged in!';
          setTimeout(()=>{ window.location.href = '/' }, 500);
        } catch (e) {
          err.textContent = 'Network error';
        }
      });
    </script>
  </body>
  </html>
