{
  "TimecodeConfig": { "Source": "ZEROBASED" },
  "Inputs": [
    {
      "FileInput": "INPUT_URI",
      "AudioSelectors": {
        "Audio Selector 1": { "DefaultSelection": "DEFAULT" }
      },
      "VideoSelector": { "Rotate": "AUTO" }
    }
  ],
  "OutputGroups": [
    {
      "Name": "HLS Portrait From Landscape",
      "OutputGroupSettings": {
        "Type": "HLS_GROUP_SETTINGS",
        "HlsGroupSettings": {
          "Destination": "s3://OUTPUT_BUCKET/DATE_YYYY_MM_DD/ASSET_ID/portrait/",
          "ManifestCompression": "NONE",
          "ManifestDurationFormat": "INTEGER",
          "StreamInfResolution": "INCLUDE",
          "SegmentLength": 4,
          "MinSegmentLength": 0,
          "DirectoryStructure": "SUBDIRECTORY_PER_STREAM",
          "SegmentsPerSubdirectory": 1000,
          "ClientCache": "ENABLED",
          "ProgramDateTime": "EXCLUDE",
          "AdditionalManifests": [
            {
              "ManifestNameModifier": "_master",
              "SelectedOutputs": ["720p_v", "540p_v"]
            }
          ]
        }
      },
      "Outputs": [
        {
          "NameModifier": "720p_v",
          "ContainerSettings": { "Container": "M3U8" },
          "VideoDescription": {
            "Width": 720,
            "Height": 1280,
            "ScalingBehavior": "DEFAULT",
            "Sharpness": 50,
            "CodecSettings": {
              "Codec": "H_264",
              "H264Settings": {
                "RateControlMode": "VBR",
                "Bitrate": 2400000,
                "GopSize": 2,
                "GopSizeUnits": "SECONDS",
                "GopClosedCadence": 1,
                "SceneChangeDetect": "ENABLED",
                "NumberBFramesBetweenReferenceFrames": 2
              }
            }
          },
          "AudioDescriptions": [
            {
              "AudioSourceName": "Audio Selector 1",
              "CodecSettings": {
                "Codec": "AAC",
                "AacSettings": {
                  "Bitrate": 128000,
                  "CodingMode": "CODING_MODE_2_0",
                  "SampleRate": 48000
                }
              }
            }
          ]
        },
        {
          "NameModifier": "540p_v",
          "ContainerSettings": { "Container": "M3U8" },
          "VideoDescription": {
            "Width": 540,
            "Height": 960,
            "ScalingBehavior": "DEFAULT",
            "Sharpness": 50,
            "CodecSettings": {
              "Codec": "H_264",
              "H264Settings": {
                "RateControlMode": "VBR",
                "Bitrate": 1500000,
                "GopSize": 2,
                "GopSizeUnits": "SECONDS",
                "GopClosedCadence": 1,
                "SceneChangeDetect": "ENABLED",
                "NumberBFramesBetweenReferenceFrames": 2
              }
            }
          },
          "AudioDescriptions": [
            {
              "AudioSourceName": "Audio Selector 1",
              "CodecSettings": {
                "Codec": "AAC",
                "AacSettings": {
                  "Bitrate": 96000,
                  "CodingMode": "CODING_MODE_2_0",
                  "SampleRate": 48000
                }
              }
            }
          ]
        }
      ]
    },
    {
      "Name": "HLS Landscape",
      "OutputGroupSettings": {
        "Type": "HLS_GROUP_SETTINGS",
        "HlsGroupSettings": {
          "Destination": "s3://OUTPUT_BUCKET/DATE_YYYY_MM_DD/ASSET_ID/landscape/",
          "ManifestCompression": "NONE",
          "ManifestDurationFormat": "INTEGER",
          "StreamInfResolution": "INCLUDE",
          "SegmentLength": 4,
          "MinSegmentLength": 0,
          "DirectoryStructure": "SUBDIRECTORY_PER_STREAM",
          "SegmentsPerSubdirectory": 1000,
          "ClientCache": "ENABLED",
          "ProgramDateTime": "EXCLUDE",
          "AdditionalManifests": [
            {
              "ManifestNameModifier": "_master",
              "SelectedOutputs": ["1080p_h", "720p_h", "480p_h"]
            }
          ]
        }
      },
      "Outputs": [
        {
          "NameModifier": "1080p_h",
          "ContainerSettings": { "Container": "M3U8" },
          "VideoDescription": {
            "Width": 1920,
            "Height": 1080,
            "ScalingBehavior": "DEFAULT",
            "Sharpness": 50,
            "CodecSettings": {
              "Codec": "H_264",
              "H264Settings": {
                "RateControlMode": "VBR",
                "Bitrate": 5000000,
                "GopSize": 2,
                "GopSizeUnits": "SECONDS",
                "GopClosedCadence": 1,
                "SceneChangeDetect": "ENABLED",
                "NumberBFramesBetweenReferenceFrames": 2
              }
            }
          },
          "AudioDescriptions": [
            {
              "AudioSourceName": "Audio Selector 1",
              "CodecSettings": {
                "Codec": "AAC",
                "AacSettings": {
                  "Bitrate": 128000,
                  "CodingMode": "CODING_MODE_2_0",
                  "SampleRate": 48000
                }
              }
            }
          ]
        },
        {
          "NameModifier": "720p_h",
          "ContainerSettings": { "Container": "M3U8" },
          "VideoDescription": {
            "Width": 1280,
            "Height": 720,
            "ScalingBehavior": "DEFAULT",
            "Sharpness": 50,
            "CodecSettings": {
              "Codec": "H_264",
              "H264Settings": {
                "RateControlMode": "VBR",
                "Bitrate": 3000000,
                "GopSize": 2,
                "GopSizeUnits": "SECONDS",
                "GopClosedCadence": 1,
                "SceneChangeDetect": "ENABLED",
                "NumberBFramesBetweenReferenceFrames": 2
              }
            }
          },
          "AudioDescriptions": [
            {
              "AudioSourceName": "Audio Selector 1",
              "CodecSettings": {
                "Codec": "AAC",
                "AacSettings": {
                  "Bitrate": 128000,
                  "CodingMode": "CODING_MODE_2_0",
                  "SampleRate": 48000
                }
              }
            }
          ]
        },
        {
          "NameModifier": "480p_h",
          "ContainerSettings": { "Container": "M3U8" },
          "VideoDescription": {
            "Width": 854,
            "Height": 480,
            "ScalingBehavior": "DEFAULT",
            "Sharpness": 50,
            "CodecSettings": {
              "Codec": "H_264",
              "H264Settings": {
                "RateControlMode": "VBR",
                "Bitrate": 1600000,
                "GopSize": 2,
                "GopSizeUnits": "SECONDS",
                "GopClosedCadence": 1,
                "SceneChangeDetect": "ENABLED",
                "NumberBFramesBetweenReferenceFrames": 2
              }
            }
          },
          "AudioDescriptions": [
            {
              "AudioSourceName": "Audio Selector 1",
              "CodecSettings": {
                "Codec": "AAC",
                "AacSettings": {
                  "Bitrate": 96000,
                  "CodingMode": "CODING_MODE_2_0",
                  "SampleRate": 48000
                }
              }
            }
          ]
        }
      ]
    }
  ]
}
