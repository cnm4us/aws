# Copy to .env and fill values if not using an EC2 instance profile.

# AWS Region to use
AWS_REGION=us-west-1

# Optional: Hardcode MediaConvert account-specific endpoint to skip discovery
# MEDIACONVERT_ENDPOINT=https://abcd123456.mediaconvert.us-east-1.amazonaws.com

# If not using an instance profile or SSO, set these
# AWS_ACCESS_KEY_ID=AKIA...
# AWS_SECRET_ACCESS_KEY=...
# AWS_SESSION_TOKEN=...

# Uploader API configuration
# Port to run the local server
PORT=3300
# S3 bucket to upload into
UPLOAD_BUCKET=bacs-mc-uploads
# Optional key prefix for uploads within the bucket ('' or e.g. 'uploads/')
UPLOAD_PREFIX=uploads/
# Maximum allowed upload size (MB)
MAX_UPLOAD_MB=200

# Database connection (MariaDB/MySQL)
DB_HOST=127.0.0.1
DB_PORT=3306
DB_USER=semantic_admin
DB_PASSWORD=Wowzers9!
DB_NAME=aws

# MediaConvert publishing
# Role ARN that MediaConvert assumes for jobs
MC_ROLE_ARN=arn:aws:iam::123456789012:role/MediaConvert_Default_Role
# Optional queue ARN
# MC_QUEUE_ARN=arn:aws:mediaconvert:us-west-1:123456789012:queues/Default
# Optional acceleration (DISABLED, ENABLED, or PREFERRED)
ACCELERATION_MODE=PREFERRED
# Optional job priority (-50..50, higher starts sooner within the same queue)
MC_PRIORITY=0
# Output bucket/prefix for HLS outputs
OUTPUT_BUCKET=bacs-mc-public-stream
OUTPUT_PREFIX=hls/
# Normalize audio loudness across produced videos (integrated loudness; ITU BS.1770)
# 1 = enabled (default), 0 = disabled
MEDIA_CONVERT_NORMALIZE_AUDIO=1

# Apply logo watermark to MediaConvert poster frame captures (t=0). 1 = enabled, 0 = disabled.
MC_WATERMARK_POSTERS=1

# Media jobs (DB-backed queue + ffmpeg mastering)
# When enabled, productions that need ffmpeg (audio mix/replace/duck) enter status=pending_media first.
MEDIA_JOBS_ENABLED=0
MEDIA_JOBS_WORKER_ENABLED=0
MEDIA_JOBS_WORKER_POLL_MS=2000
MEDIA_JOBS_LOGS_BUCKET=bacs-mc-uploads
MEDIA_JOBS_LOGS_PREFIX=media-jobs/logs/

# When enabled, ffmpeg performs all audio/video compositing (logos/lower-thirds/screen-titles/etc.)
# and MediaConvert is used only for packaging (CMAF/HLS + posters). Defaults to on when MEDIA_JOBS_ENABLED=1.
MEDIA_FFMPEG_COMPOSITE_ENABLED=1

# Screen title renderer:
# - drawtext (default): ffmpeg drawtext directly on video frames
# - pango: render a PNG overlay with Pango+Cairo, then overlay it (better typography / wrapping)
SCREEN_TITLE_RENDERER=drawtext
# Status poll interval (ms)
STATUS_POLL_MS=30000
# Optional logs directory for request payloads
REQUEST_LOGS_DIR=logs/request
# Optional admin token (if set, required for sign/publish)
# ADMIN_TOKEN=changeme
# Optional: CloudFront domain to build public URLs (no protocol)
# e.g., d1234abcd.cloudfront.net or media.example.com
CLOUDFRONT_DOMAIN=
